vcf
class(vcf)
attributes(vcf)
vcf[vcf==1/1]=2
vcf
vcf[vcf=="1/1"]=2
warnings()
vcf
vcf=read.csv(textConnection(res[[1]]),sep="\t",header=F)
vcf
vcf[vcf=="1/1"]
vcf[vcf=="1/0"]
vcf[vcf==1/0]
as.vector(vcf)
v=as.vector(vcf)
v[v==1/0]
v[v=="1/0"]
class(v)
attributes(vcf)
vcf[1]
vcf[10]
vcf[1:length(vcf)]
w=vcf[1:length(vcf)]
class(w)
factor(w)
factor(vcf)
levels(vcf)
class(vcf[1])
class(vcf[1,1])
w=vcf[1,1:length(vcf)]
w
class(w)
?factor
factor(1/1)
as.character(vcf)
as.character(vcf[1,1])
as.character(vcf[1,10])
as.numeric(vcf[1,10])
as.character(vcf[1,10])
as.character(vcf[1,1:length(vcf)])
mode(vcf)
mode(vcf[1,10])
res[[1]]
r2=res
gsub("1/1","2",r2)
r2=gsub("1/1","2",r2)
r2=gsub("1/0","1",r2)
r2=gsub("0/1","1",r2)
r2=gsub("0/0","0",r2)
r2
tbx <- TabixFile("http://genome-data.cri.uchicago.edu/ahga/archdata/allpops_auto_maf0.005geno0.1.vcf.gz")
param <- GRanges(c("chr15"), IRanges(c(28365618, 28365618 ), width=1))
res=scanTabix(tbx, param=param)
r2=gsub("1/1","2",r2)
r2=gsub("1/0","1",r2)
r2=gsub("0/1","1",r2)
r2=gsub("0/0","0",r2)
vcf=read.csv(textConnection(r2[[1]]),sep="\t",header=F)
header=read.csv(textConnection(headerTabix(tbx)[["header"]][length(h[["header"]])]),sep="\t",header=F)
colnames(vcf) = unlist(header)
vcf
head(vcf)
samps
s=getSamples()
s
vcf
vcf[1:10]
vcf[1:9]
genos=vcf[10:length(vcf)]
genos
length(genos)
names(genos)
s[names(genos)]
s
names(genos)
class(names(genos))
s[names(genos)]
s[names(genos[938])]
names(genos[938])
s
s(genos[938])
s[genos[938]]
s
s[,names(genos[938])]
s[,names(genos[genos])]
s[,names(genos)]
genos[names(s)]
genos[colnames(s)]
genos
genos[colnames(s)]
rbind(s,genos[colnames(s)])
genos[colnames(s)]
class(s)
g=genos[colnames(s)]
class(g)
g=as.vector(genos[colnames(s)])
g
rbind(s,g)
length(g)
length(s)
ncol(s)
head(g)
class(g)
g=as.vector(genos[colnames(s)][1:length(s)]
)
class(genos)
genos=vcf[1,10:length(vcf)]
class(genos)
genos
genos=as.vector(vcf[1,10:length(vcf)])
class(genos)
class(as.numeric(genos))
g=class(as.numeric(genos))
g
g=as.numeric(genos)
g
unlist(genos)
class(unlist(genos))
genos=unlist(vcf[1,10:length(vcf)])
genos
rbind(s,genos[names(s)])
genos[names(s)]
genos[colnames(s)]
rbind(s,genos[colnames(s)])
s=data.frame(s)
s
genos=vcf[1,10:length(vcf)]
rbind(s,genos[colnames(s)])
genos[colnames(s)]
s
list(s,genos[colnames(s)])
c(s,genos[colnames(s)])
s
g=genos[colnames(s)]
g
merge(s,g)
ncol(s)
ncol(g)
s
g
rbind(s,g)
warnings()
g
s
rbind(s,g,stringAsFactors=T)
rbind(s,g,stringsAsFactors=T)
rbind(s,g,check.rows=T)
rbind(s,g,stringsAsFactors=F)
cbind(t(s),t(g))
cbind(t(s),t(g),stringsAsFactors=T)
data.frame(t(s),t(g),stringsAsFactors=T)
k=data.frame(t(s),t(g),stringsAsFactors=T)
genos=vcf[colnames(s)]
genos
genos=vcf[colnames(s),10:length(vcf)]
k=data.frame(t(s),t(g),stringsAsFactors=TRUE)
k
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
genos
s
s
vcf
genos
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
genos
k
rm(s)
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
parseSNPID("rs12913832")
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
parseSNPID("rs12913832")
parseSNPID("rs12913832",build="B37")
tbs
tbx
getSNP("rs12913832")
snp=parseSNPID("rs12913832",build="B37")
snp$chr_name
snp
snp$chr
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
test("rs12913832")
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
test("rs12913832")
k=test("rs12913832")
?group
k
levels(k)
colnames(k)
colnames(k)=c("Population","Region","Genotype")
colnames(k)
aggregate(k$Genotype,byk$Population,sum)
aggregate(k$Genotype,by=k$Population,sum)
coord
coords
coords=getCoords()
coords
tapply(k$Genotype,k$Population,sum)
k
s=getSamples()
s
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k=test("rs12913832")
k
tapply(k$Genotype,k$Population,sum)
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k=test("rs12913832")
tapply(k$Genotype,k$Population,sum)
colnames(k)
colnames(k[,3])="Genotype"
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k=test("rs12913832")
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k=test("rs12913832")
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k=test("rs12913832")
tapply(k$Genotype,k$Population,sum)
tapply(k$Genotype,k$Population,count)
tapply(k$Genotype,k$Region,sum)
tapply(k$Genotype,k$Region,!is.na)
tapply(k$Genotype,k$Region,is.na)
tapply(k$Genotype,k$Region,f(x){return(sum(is.na(x)))})
tapply(k$Genotype,k$Region,funciton(x){return(sum(is.na(x)))})
tapply(k$Genotype,k$Region,function(x){return(sum(is.na(x)))})
tapply(k$Genotype,k$Region,function(x){return(sum(!is.na(x)))})
tapply(k$Genotype,k$Region,function(x){return(2*sum(!is.na(x)))})
tapply(k$Genotype,k$Region,sum)/tapply(k$Genotype,k$Region,function(x){return(2*sum(!is.na(x)))})
tapply(k$Genotype,k$Population,sum)/tapply(k$Genotype,k$Population,function(x){return(2*sum(!is.na(x)))})
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
j
k
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
res=getXML(refresh=T)
b=res[[1]]$children
b
b
getNodeSet(b,"//Population")
getNodeSet(b,"//Label")
res
getNodeSet(res[[2]],"//Label")
getNodeSet(res[[2]],"//Sample")
res[[2]]
res[[1]]
getNodeSet(res[[1]],"//Sample")
getNodeSet(res[[1]],"//Sample/Population@level=1")
getNodeSet(res[[1]],"//Sample/Population[@level='1']")
getNodeSet(res[[1]],"//Sample/Population[@level='2']")
getNodeSet(res[[1]],"//Sample/Population[@level='3']")
getNodeSet(res[[1]],"//Population")
getNodeSet(res[[1]],"//Population[@level=1]")
getNodeSet(res[[1]],"//Labels")
getNodeSet(res[[1]],"//Label")
getNodeSet(res[[1]],"//Sample")
getNodeSet(res[[1]],"//Sample")[[1]]
class(getNodeSet(res[[1]],"//Sample")[[1]])
getNodeSet(getNodeSet(res[[1]],"//Sample")[[1]],//Population)
getNodeSet(getNodeSet(res[[1]],"//Sample")[[1]],"//Population")
length(getNodeSet(getNodeSet(res[[1]],"//Sample")[[1]],"//Population"))
plevels=33
path <- paste("//Sample/Population[@level='",plevels,"']")
path
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",plevels,"']", sep = "")
p <-getNodeSet(res[[1]], path)
samp_pops <- c(samp_pops, p)
}
plevels <- length(getNodeSet(getNodeSet(res[[1]], "//Sample")[[1]], "//Population"))
samp_ids <- getNodeSet(res[[1]], "//Label")
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",plevels,"']", sep = "")
p <-getNodeSet(res[[1]], path)
samp_pops <- c(samp_pops, p)
}
plevels
plevels <- length(getNodeSet(getNodeSet(res[[1]], "//Sample")[[1]], "//Population"))
samp_ids <- getNodeSet(res[[1]], "//Label")
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",plevels,"']", sep = "")
p <-getNodeSet(res[[1]], path)
samp_pops <- c(samp_pops, p)
}
samp_pops
samp_ids <- getNodeSet(res[[1]], "//Label")
samp_ids
samp_ids <- sapply(getNodeSet(res[[1]], "//Label"), function(x){xmlValue(x)})
samp_ids
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",plevels,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- c(samp_pops, p)
}
samp_pops
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",plevels,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- c(samp_pops, p)
}
samp_pops
samp_pops[[1]]
samp_pops[1]
class(samp_pops)
head(samp_pops)
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",plevels,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- list(samp_pops, p)
}
samp_pops
path
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",i,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- list(samp_pops, p)
}
samp_pops
samp_pops[[1]]
samp_ids
data.frame(samp_pops)
length(samp_pops)
sampe_pops[1]
samp_pops[1]
samp_pops[2]
samp_pops <- list()
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",i,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- list(samp_pops, p)
}
samp_pops[1]
?"data.frame"
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",i,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops[[length(samp_pops) + 1]] <- p
}
samp_pops[1]
samp_pops
data.frame(samp_pops)
data.frame(t(samp_pops))
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",i,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- cbind(samp_pops, t(p))
# samp_pops[[length(samp_pops) + 1]] <- p
}
samp_pops
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",i,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- cbind(samp_pops, p)
# samp_pops[[length(samp_pops) + 1]] <- p
}
samp_pops
paste("pop_level",1:3,sep="")
getSamples <- function() {
res <- getXML()
plevels <- length(getNodeSet(getNodeSet(res[[1]], "//Sample")[[1]], "//Population"))
samp_ids <- sapply(getNodeSet(res[[1]], "//Label"), function(x){xmlValue(x)})
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",i,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- cbind(samp_pops, p)
# samp_pops[[length(samp_pops) + 1]] <- p
}
colnames(samp_pops) <- paste("pop_level", 1:plevels, sep = "")
names(samp_pops) <- samp_ids
return(samp_pops)
}
getSamples()
getSamples <- function() {
res <- getXML()
plevels <- length(getNodeSet(getNodeSet(res[[1]], "//Sample")[[1]], "//Population"))
samp_ids <- sapply(getNodeSet(res[[1]], "//Label"), function(x){xmlValue(x)})
samp_pops <- NULL
for (i in 1:plevels) {
path <- paste("//Sample/Population[@level='",i,"']", sep = "")
p <- sapply(getNodeSet(res[[1]], path), function(x){xmlValue(x)})
samp_pops <- cbind(samp_pops, p)
# samp_pops[[length(samp_pops) + 1]] <- p
}
colnames(samp_pops) <- paste("pop_level", 1:plevels, sep = "")
rownames(samp_pops) <- samp_ids
return(samp_pops)
}
getSamples()
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k
k[-1]
c=colnames(k)
c[-1]
c[length(c)]
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
head(k)
getFreq(k)
getFreq(k,level=2)
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getSamples()
getSamples()
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getSamples()
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getSamples()
getSamples()
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getSamples()
k
getFreq(k)
b=k
rm(k)
getFreq(b)
b
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getFreq(k)
getFreq(k,level=2)
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getPopLevels()
getPopLevels()
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getPopLevels()
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getFreq(level=2)
getFreq(k,level=2)
getFreq(k,level=3)
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getFreq(k)
getFreq(k,level=2)
getFreq(k,level=3)
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
paste0("a","b)
paste0("a","b)")
paste0("a","b\)")
paste0("a","b)")
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
paste0("a",getPopLevels())
paste0("a",getPopLevels(),"adsf")
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getFreq(k,level=3)
getFreq(k,level=0)
getFreq(k,level=2)
k
colnames(k)
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
parseVCFHeader()
parseVCFHeader(tbx)
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
getVCF()
parseAlleles()
k
colnames(k)
alleles=parseAlleles()
alleles
alleles["REF"]=alleles["ALT"]
alleles
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
k
getCoords()
buildGeojson(k,getCoords)
buildGeojson(k,getCoords())
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
buildGeojson(k,getCoords())
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
buildGeojson(k,getCoords())
parseAlleles()
a=parseAlleles()
a
a["REF"]
a[1,"REF"]
pop=k[1,"pop_level1"]
pop
pop=as.character(k[1,"pop_level1"])
pop=as.character(k[1,"pop_level1"])
pop=k[1,"pop_level1"]
pop=as.character(k[1,"pop_level1"])
pop
as.character(a["REF"])
as.character(a[1,"REF"])
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
buildGeojson(k,getCoords())
k[1,"Genotype"]
class(k[1,"Genotype"])
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
buildGeojson(k,getCoords())
parseAlleles()
source('~/Dropbox/DataViz/RGGV/R/RGGV_2.R')
buildGeojson(k,getCoords())
